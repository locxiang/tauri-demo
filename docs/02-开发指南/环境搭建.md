# 环境搭建

## 📋 系统要求

### 操作系统
- **macOS**: 10.15+ (Catalina及以上)
- **Windows**: 10+ (推荐Windows 11)
- **Linux**: Ubuntu 18.04+, CentOS 7+ (实验性支持)

### 硬件要求
- **CPU**: 2核心以上
- **内存**: 4GB以上 (推荐8GB)
- **磁盘**: 2GB可用空间
- **网络**: 需要管理员权限进行网络抓包

## 🛠️ 开发工具安装

### 1. Node.js 环境
```bash
# 使用nvm安装(推荐)
curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.0/install.sh | bash
nvm install 18
nvm use 18

# 或直接下载安装
# https://nodejs.org/en/download/
```

### 2. Rust 环境
```bash
# 安装 Rust
curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh

# 重新加载环境变量
source ~/.cargo/env

# 验证安装
rustc --version
cargo --version
```

### 3. pnpm 包管理器
```bash
# 安装 pnpm
npm install -g pnpm

# 验证安装
pnpm --version
```

### 4. Tauri CLI
```bash
# 安装 Tauri CLI
cargo install tauri-cli

# 验证安装
cargo tauri --version
```

## 🔧 平台特定配置

### macOS 配置

#### 安装 Xcode Command Line Tools
```bash
xcode-select --install
```

#### 网络抓包权限配置
```bash
# 方法1: 安装 Wireshark (推荐)
brew install --cask wireshark

# 方法2: 手动安装 ChmodBPF
sudo /usr/sbin/installer -pkg /Library/Application\ Support/Wireshark/ChmodBPF/ChmodBPF.pkg -target /
```

#### 验证权限
```bash
# 检查 ChmodBPF 是否正确安装
ls -la /Library/LaunchDaemons/org.wireshark.ChmodBPF.plist
```

### Windows 配置

#### 安装 Visual Studio Build Tools
```bash
# 下载并安装 Visual Studio Build Tools
# https://visualstudio.microsoft.com/downloads/#build-tools-for-visual-studio-2022

# 或安装 Visual Studio Community
# https://visualstudio.microsoft.com/vs/community/
```

#### 网络抓包权限配置
```bash
# 下载安装 Npcap
# https://npcap.com/#download

# 安装时勾选 "Install Npcap in WinPcap API-compatible Mode"
```

#### 验证权限
```powershell
# 检查 Npcap 是否正确安装
ls C:\Windows\System32\Npcap
```

## 📦 项目依赖安装

### 1. 克隆项目
```bash
git clone <repository-url>
cd big-data-rpa-v4
```

### 2. 安装前端依赖
```bash
# 安装依赖
pnpm install

# 验证安装
pnpm list
```

### 3. 安装后端依赖
```bash
# 进入 Rust 项目目录
cd src-tauri

# 检查依赖
cargo check

# 构建项目
cargo build
```

## 🚀 开发环境启动

### 1. 开发模式启动
```bash
# 启动开发服务器
pnpm tauri dev

# 或分别启动前后端
pnpm dev  # 前端开发服务器
```

### 2. 验证功能
- **网络抓包**: 检查是否能正常检测网络设备
- **权限状态**: 确认系统权限配置正确
- **日志输出**: 查看控制台和日志文件

## 🔍 开发工具推荐

### VS Code 扩展
```json
{
  "recommendations": [
    "rust-lang.rust-analyzer",
    "Vue.volar",
    "Vue.vscode-typescript-vue-plugin",
    "bradlc.vscode-tailwindcss",
    "esbenp.prettier-vscode",
    "dbaeumer.vscode-eslint"
  ]
}
```

### VS Code 配置
```json
{
  "rust-analyzer.linkedProjects": ["src-tauri/Cargo.toml"],
  "vue.inlayHints.missingProps": true,
  "tailwindCSS.includeLanguages": {
    "vue": "html"
  }
}
```

## 🐛 调试配置

### VS Code 调试配置
```json
{
  "version": "0.2.0",
  "configurations": [
    {
      "name": "Debug Tauri",
      "type": "lldb",
      "request": "launch",
      "program": "${workspaceFolder}/src-tauri/target/debug/big-data-rpa-v4",
      "args": [],
      "cwd": "${workspaceFolder}",
      "environment": [
        {
          "name": "RUST_BACKTRACE",
          "value": "1"
        }
      ]
    }
  ]
}
```

### Chrome DevTools
```bash
# 启用 Chrome DevTools
pnpm tauri dev --debug
```

## 📊 环境验证

### 验证脚本
```bash
#!/bin/bash
# 环境验证脚本

echo "🔍 环境检查..."

# 检查 Node.js
if command -v node &> /dev/null; then
    echo "✅ Node.js: $(node --version)"
else
    echo "❌ Node.js 未安装"
fi

# 检查 Rust
if command -v rustc &> /dev/null; then
    echo "✅ Rust: $(rustc --version)"
else
    echo "❌ Rust 未安装"
fi

# 检查 pnpm
if command -v pnpm &> /dev/null; then
    echo "✅ pnpm: $(pnpm --version)"
else
    echo "❌ pnpm 未安装"
fi

# 检查 Tauri CLI
if command -v cargo-tauri &> /dev/null; then
    echo "✅ Tauri CLI: $(cargo tauri --version)"
else
    echo "❌ Tauri CLI 未安装"
fi

# 检查网络抓包权限
if [[ "$OSTYPE" == "darwin"* ]]; then
    if [[ -f "/Library/LaunchDaemons/org.wireshark.ChmodBPF.plist" ]]; then
        echo "✅ macOS: ChmodBPF 已安装"
    else
        echo "❌ macOS: ChmodBPF 未安装"
    fi
elif [[ "$OSTYPE" == "msys" ]]; then
    if [[ -d "C:/Windows/System32/Npcap" ]]; then
        echo "✅ Windows: Npcap 已安装"
    else
        echo "❌ Windows: Npcap 未安装"
    fi
fi
```

## 🚨 常见问题

### 1. Rust 编译错误
```bash
# 更新 Rust 工具链
rustup update

# 清理缓存
cargo clean
```

### 2. 前端依赖问题
```bash
# 清理 node_modules
rm -rf node_modules
rm pnpm-lock.yaml

# 重新安装
pnpm install
```

### 3. 权限问题
```bash
# macOS: 重新安装 ChmodBPF
sudo launchctl unload /Library/LaunchDaemons/org.wireshark.ChmodBPF.plist
sudo launchctl load /Library/LaunchDaemons/org.wireshark.ChmodBPF.plist

# Windows: 以管理员身份运行
# 右键点击应用图标 -> "以管理员身份运行"
```

### 4. 网络抓包失败
```bash
# 检查网络设备
ip link show  # Linux
ifconfig      # macOS
ipconfig      # Windows

# 检查防火墙设置
sudo ufw status  # Linux
# 系统偏好设置 -> 安全性与隐私 -> 防火墙  # macOS
# 控制面板 -> 系统和安全 -> Windows Defender 防火墙  # Windows
```

## 📚 参考资料

- [Tauri官方文档](https://tauri.app/v1/guides/)
- [Vue 3官方文档](https://vuejs.org/guide/)
- [Rust官方文档](https://doc.rust-lang.org/)
- [pnpm官方文档](https://pnpm.io/)