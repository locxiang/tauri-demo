# 常见问题

## 🔧 安装和环境问题

### Q1: 如何解决"找不到网络设备"的问题？

**A1:** 这通常是权限问题导致的。请按照以下步骤解决：

**macOS:**
```bash
# 1. 安装 ChmodBPF（推荐使用 Wireshark 安装）
brew install --cask wireshark

# 2. 手动检查权限
sudo dscl . -read /Groups/access_bpf

# 3. 重启应用
```

**Windows:**
```bash
# 1. 以管理员身份运行 PowerShell
# 2. 安装 Npcap
# 下载链接：https://npcap.com/#download
# 安装时勾选 "Install Npcap in WinPcap API-compatible Mode"

# 3. 以管理员身份运行应用
```

### Q2: 应用启动时提示"依赖缺失"怎么办？

**A2:** 检查并安装必要的依赖：

```bash
# 检查 Node.js 版本
node --version  # 需要 18+

# 检查 Rust 版本
rustc --version  # 需要 1.70+

# 重新安装依赖
pnpm install
cd src-tauri && cargo build
```

### Q3: 为什么抓包功能无法正常工作？

**A3:** 可能的原因和解决方案：

1. **权限问题**
   ```bash
   # macOS: 重启 ChmodBPF 服务
   sudo launchctl unload /Library/LaunchDaemons/org.wireshark.ChmodBPF.plist
   sudo launchctl load /Library/LaunchDaemons/org.wireshark.ChmodBPF.plist
   
   # Windows: 以管理员身份运行
   ```

2. **网络设备问题**
   ```bash
   # 检查网络设备状态
   ip link show      # Linux/macOS
   ipconfig /all     # Windows
   ```

3. **防火墙阻止**
   - 检查系统防火墙设置
   - 将应用添加到防火墙白名单

## 🔐 认证和Token问题

### Q4: Token认证失败或过期怎么处理？

**A4:** 按照以下步骤排查：

1. **检查系统URL配置**
   ```bash
   # 确认目标系统URL是否正确
   # 检查系统是否正常运行
   ```

2. **清除Token缓存**
   - 在"系统权限"页面点击"清除Token"
   - 重新进行认证流程

3. **检查网络连接**
   ```bash
   # 测试与目标系统的连接
   ping 23.210.227.16
   telnet 23.210.227.16 80
   ```

### Q5: 如何添加新的认证系统？

**A5:** 需要修改后端代码：

```rust
// 1. 在 src-tauri/src/auth/systems/ 目录创建新文件
// 例如：system_new.rs

pub struct SystemNew {
    // 系统配置
}

impl SystemAuth for SystemNew {
    fn system_id(&self) -> &str { "system_new" }
    fn system_name(&self) -> &str { "新系统" }
    
    fn process_http_request(&mut self, packet: &HttpPacket) -> Result<Option<TokenInfo>> {
        // 实现认证逻辑
    }
}

// 2. 在 registry.rs 中注册新系统
pub fn create_all_systems() -> Vec<Box<dyn SystemAuth + Send + Sync>> {
    vec![
        // 现有系统...
        Box::new(system_new::create_system()),
    ]
}
```

## 🌐 网络和连接问题

### Q6: 网络抓包数据不完整或丢失？

**A6:** 检查以下方面：

1. **缓冲区设置**
   ```rust
   // 增加缓冲区大小
   let mut cap = Capture::from_device(device)?
       .buffer_size(1000000)  // 1MB 缓冲区
       .snaplen(65535)        // 最大抓包长度
       .open()?;
   ```

2. **网络负载**
   - 检查网络负载是否过高
   - 考虑增加过滤条件

3. **系统资源**
   - 检查CPU和内存使用率
   - 关闭不必要的程序

### Q7: 代理环境下无法正常工作？

**A7:** 配置代理设置：

```bash
# 设置环境变量
export HTTP_PROXY=http://proxy.company.com:8080
export HTTPS_PROXY=http://proxy.company.com:8080
export NO_PROXY=localhost,127.0.0.1,23.210.*

# 或在应用中配置代理
```

## 💾 数据和存储问题

### Q8: 应用数据存储在哪里？

**A8:** 数据存储位置：

**macOS:**
```bash
~/Library/Application Support/com.sumi.big-data-rpa-v4/
```

**Windows:**
```bash
%APPDATA%\com.sumi.big-data-rpa-v4\
```

**Linux:**
```bash
~/.local/share/com.sumi.big-data-rpa-v4/
```

### Q9: 如何清理应用数据？

**A9:** 清理步骤：

1. **关闭应用**
2. **删除数据目录**
   ```bash
   # macOS
   rm -rf ~/Library/Application\ Support/com.sumi.big-data-rpa-v4/
   
   # Windows
   rmdir /s "%APPDATA%\com.sumi.big-data-rpa-v4"
   
   # Linux
   rm -rf ~/.local/share/com.sumi.big-data-rpa-v4/
   ```

3. **重新启动应用**

## 🎨 界面和体验问题

### Q10: 界面显示异常或乱码？

**A10:** 解决方案：

1. **检查系统字体**
   ```bash
   # 确保系统安装了必要的字体
   # 特别是中文字体
   ```

2. **重置界面设置**
   - 删除应用配置文件
   - 重新启动应用

3. **更新显卡驱动**
   - 确保显卡驱动是最新版本

### Q11: 应用卡顿或响应慢？

**A11:** 性能优化：

1. **检查系统资源**
   ```bash
   # 查看CPU和内存使用情况
   top        # macOS/Linux
   taskmgr    # Windows
   ```

2. **减少数据量**
   - 增加过滤条件
   - 定期清理历史数据

3. **关闭不必要的功能**
   - 暂停不需要的监控
   - 调整数据更新频率

## 🔄 更新和升级问题

### Q12: 如何更新应用？

**A12:** 更新步骤：

1. **检查更新**
   ```bash
   # 查看当前版本
   git tag -l
   
   # 拉取最新代码
   git pull origin main
   ```

2. **重新构建**
   ```bash
   # 更新依赖
   pnpm install
   cd src-tauri && cargo build --release
   
   # 构建应用
   pnpm tauri build
   ```

3. **备份数据**
   - 更新前备份重要数据
   - 导出配置文件

### Q13: 更新后配置丢失？

**A13:** 恢复配置：

1. **从备份恢复**
   ```bash
   # 恢复配置文件
   cp backup/config.json ~/.config/app/
   ```

2. **重新配置**
   - 重新设置网络设备
   - 重新配置认证系统

## 🛠️ 开发和调试问题

### Q14: 开发环境如何调试？

**A14:** 调试方法：

1. **前端调试**
   ```bash
   # 启用开发者工具
   pnpm tauri dev --debug
   
   # 查看浏览器控制台
   # 按 F12 打开开发者工具
   ```

2. **后端调试**
   ```bash
   # 启用 Rust 调试
   export RUST_BACKTRACE=1
   export RUST_LOG=debug
   
   # 使用 VS Code 调试
   # 配置 launch.json
   ```

3. **日志调试**
   ```bash
   # 查看应用日志
   tail -f ~/Library/Logs/com.sumi.big-data-rpa-v4/app.log
   ```

### Q15: 如何报告Bug或请求功能？

**A15:** 反馈渠道：

1. **GitHub Issues**
   - 提交详细的Bug报告
   - 包含错误日志和截图

2. **错误信息收集**
   ```bash
   # 收集系统信息
   uname -a
   node --version
   rustc --version
   
   # 收集应用日志
   # 在报告中包含相关日志
   ```

3. **功能请求**
   - 详细描述需求
   - 说明使用场景
   - 提供设计建议

## 📋 其他问题

### Q16: 应用占用资源过多？

**A16:** 优化建议：

1. **调整配置**
   ```json
   {
     "capture": {
       "buffer_size": 100000,
       "max_packets": 10000
     },
     "ui": {
       "update_interval": 1000
     }
   }
   ```

2. **定期清理**
   - 清理历史数据
   - 重启应用

### Q17: 如何获取技术支持？

**A17:** 支持渠道：

1. **文档查阅**
   - 查看完整文档
   - 搜索相关问题

2. **社区支持**
   - 参与技术讨论
   - 查看FAQ和Wiki

3. **专业支持**
   - 联系技术支持团队
   - 提供详细的问题描述

---

## 🔍 问题排查清单

遇到问题时，请按照以下清单逐一排查：

- [ ] 检查系统权限（网络抓包权限）
- [ ] 验证网络连接（ping目标系统）
- [ ] 查看应用日志（错误信息）
- [ ] 检查系统资源（CPU、内存）
- [ ] 验证依赖版本（Node.js、Rust）
- [ ] 重启应用和系统
- [ ] 尝试重新安装

如果问题仍然存在，请收集以下信息后寻求帮助：

1. **系统信息** - 操作系统版本、硬件配置
2. **应用版本** - 当前使用的应用版本
3. **错误日志** - 完整的错误日志信息
4. **重现步骤** - 详细的问题重现步骤
5. **环境信息** - 网络环境、代理设置等

我们会尽快为您提供解决方案！